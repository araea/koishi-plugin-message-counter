# koishi-plugin-message-counter ğŸ“Š

[![npm](https://img.shields.io/npm/v/koishi-plugin-message-counter?style=flat-square)](https://www.npmjs.com/package/koishi-plugin-message-counter)

## ğŸ‰ ç®€ä»‹

ç”¨äºç»Ÿè®¡ç¾¤èŠæˆå‘˜çš„å‘è¨€æ´»è·ƒåº¦ã€‚ ğŸ“ˆ å®ƒèƒ½å¤Ÿè¿½è¸ªç¾¤å†…ç”¨æˆ·çš„æ¯æ—¥ã€æ¯å‘¨ã€æ¯æœˆã€æ¯å¹´ä»¥åŠæ€»å‘è¨€æ¬¡æ•°ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆç¾è§‚çš„æ’è¡Œæ¦œï¼ŒåŒ…æ‹¬æ—¥æ¦œã€å‘¨æ¦œã€æœˆæ¦œã€å¹´æ¦œã€æ€»æ¦œä»¥åŠè·¨ç¾¤æ€»æ¦œï¼ˆåœ£é¾™ç‹æ¦œï¼‰ğŸ²ã€‚

ä½ å¯ä»¥é…ç½®æ’ä»¶è‡ªåŠ¨æ¨é€æ’è¡Œæ¦œåˆ°æŒ‡å®šç¾¤èŠï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡ä»¤æ‰‹åŠ¨æŸ¥è¯¢ã€‚æ­¤å¤–ï¼Œæ’ä»¶è¿˜æä¾›äº†ä¸°å¯Œçš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œä¾‹å¦‚æ˜¯å¦ç»Ÿè®¡æœºå™¨äººè‡ªèº«çš„å‘è¨€ ğŸ¤–ã€æ˜¯å¦ç¦è¨€æ¯æ—¥å‘è¨€æœ€å¤šçš„ç”¨æˆ·ï¼ˆé¾™ç‹ï¼‰ğŸ™Šã€è‡ªå®šä¹‰æ’è¡Œæ¦œæ˜¾ç¤ºäººæ•°ã€éšè—ç‰¹å®šç”¨æˆ·æˆ–é¢‘é“ç­‰ç­‰ã€‚

## ğŸ“¦ å®‰è£…

```
å‰å¾€ Koishi æ’ä»¶å¸‚åœºæ·»åŠ è¯¥æ’ä»¶å³å¯ ğŸš€
```

## ğŸ® ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ä½¿ç”¨

- æ’ä»¶ä»…ç»Ÿè®¡ç¾¤èŠæ¶ˆæ¯ï¼Œç§èŠæ¶ˆæ¯ä¸ä¼šè¢«è®°å½• ğŸ™ˆã€‚
- å»ºè®®ä¸ºæ’ä»¶æŒ‡ä»¤è®¾ç½®åˆ«åï¼Œæ–¹ä¾¿ç”¨æˆ·å¿«é€ŸæŸ¥è¯¢ ğŸš€ã€‚

### é«˜çº§åŠŸèƒ½ï¼šè‡ªå®šä¹‰æ°´å¹³æŸ±çŠ¶å›¾

æ°´å¹³æŸ±çŠ¶å›¾æ ·å¼ 3 æ”¯æŒå¼ºå¤§çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œè®©ä½ çš„æ’è¡Œæ¦œæ›´åŠ ä¸ªæ€§åŒ–ï¼ğŸ¨

* **è‡ªå®šä¹‰ç”¨æˆ·å›¾æ ‡**:
  - åœ¨ `data/messageCounterIcons` æ–‡ä»¶å¤¹ä¸‹æ·»åŠ ç”¨æˆ·å›¾æ ‡ï¼Œæ–‡ä»¶åä¸ºç”¨æˆ· ID (ä¾‹å¦‚ `1234567890.png`)ã€‚
  - æ”¯æŒä¸ºåŒä¸€ç”¨æˆ·æ·»åŠ å¤šä¸ªå›¾æ ‡ï¼Œå®ƒä»¬ä¼šåŒæ—¶æ˜¾ç¤ºã€‚å¤šä¸ªå›¾æ ‡çš„æ–‡ä»¶åéœ€å½¢å¦‚  `1234567890-1.png`ã€ `1234567890-2.png` ã€‚
* **è‡ªå®šä¹‰æ°´å¹³æŸ±çŠ¶æ¡èƒŒæ™¯**:
  - åœ¨ `data/messageCounterBarBgImgs` æ–‡ä»¶å¤¹ä¸‹æ·»åŠ æ°´å¹³æŸ±çŠ¶æ¡èƒŒæ™¯å›¾ç‰‡ï¼Œå»ºè®®å›¾ç‰‡å°ºå¯¸ä¸º 850*50 åƒç´ ï¼Œæ–‡ä»¶åä¸ºç”¨æˆ· ID (ä¾‹å¦‚
    `1234567890.png`)ã€‚
  - æ”¯æŒä¸ºåŒä¸€ç”¨æˆ·æ·»åŠ å¤šä¸ªèƒŒæ™¯å›¾ç‰‡ï¼Œæ’ä»¶ä¼šéšæœºé€‰æ‹©ä¸€ä¸ªæ˜¾ç¤ºã€‚å¤šä¸ªå›¾ç‰‡çš„æ–‡ä»¶åéœ€å½¢å¦‚ `1234567890-1.png`ã€`1234567890-2.png`ã€‚

> æ·»åŠ å®Œå›¾ç‰‡åï¼Œè®°å¾—é‡å¯æ’ä»¶ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼ ğŸ”„

## âš™ï¸ é…ç½®é¡¹

### åŠŸèƒ½è®¾ç½®

- `isYesterdayCommentRankingDisabled`: æ˜¯å¦ç¦ç”¨æ˜¨æ—¥å‘è¨€æ’è¡Œæ¦œï¼Œé»˜è®¤ä¸º `false` ğŸ”•ã€‚

### æ’è¡Œæ¦œæ˜¾ç¤ºè®¾ç½®

- `defaultMaxDisplayCount`: æ’è¡Œæ¦œé»˜è®¤æ˜¾ç¤ºçš„äººæ•°ï¼Œé»˜è®¤ä¸º `20` ğŸ‘¥ã€‚
- `isTimeInfoSupplementEnabled`: æ˜¯å¦åœ¨æ˜¾ç¤ºæ’è¡Œæ¦œæ—¶è¡¥å……æ—¶é—´ä¿¡æ¯ï¼Œé»˜è®¤ä¸º `true` â°ã€‚
- `isUserMessagePercentageVisible`: æ˜¯å¦åœ¨æ’è¡Œæ¦œä¸­æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯å æ¯”ï¼Œé»˜è®¤ä¸º `false` ğŸ“Šã€‚
- `hiddenUserIdsInLeaderboard`: åœ¨æ’è¡Œæ¦œä¸­éšè—çš„ç”¨æˆ· ID åˆ—è¡¨ï¼Œé»˜è®¤ä¸ºç©ºæ•°ç»„ [] ğŸ‘¤ã€‚
- `hiddenChannelIdsInLeaderboard`: åœ¨æ’è¡Œæ¦œä¸­éšè—çš„é¢‘é“ ID åˆ—è¡¨ï¼Œé»˜è®¤ä¸ºç©ºæ•°ç»„ [] ğŸ“¡ã€‚

### æ¶ˆæ¯è¿½è¸ªè®¾ç½®

- `isBotMessageTrackingEnabled`: æ˜¯å¦ç»Ÿè®¡æœºå™¨äººè‡ªèº«å‘é€çš„æ¶ˆæ¯ï¼Œé»˜è®¤ä¸º `false` ğŸ¤–ã€‚

### å›¾ç‰‡è½¬æ¢åŠŸèƒ½è®¾ç½®

- `isTextToImageConversionEnabled`: æ˜¯å¦å¼€å¯å°†æ–‡æœ¬è½¬æ¢ä¸ºå›¾ç‰‡çš„åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰ï¼Œéœ€å¯ç”¨ `markdownToImage` æœåŠ¡ ğŸ–¼ï¸ã€‚
- `isLeaderboardToHorizontalBarChartConversionEnabled`: æ˜¯å¦å¼€å¯å°†æ’è¡Œæ¦œè½¬æ¢ä¸ºæ°´å¹³æŸ±çŠ¶å›¾çš„åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰ï¼Œéœ€å¯ç”¨
  `markdownToImage` æœåŠ¡ ğŸ“Šã€‚
- `imageType`: å›¾ç‰‡ç±»å‹ï¼Œå¯é€‰å€¼ä¸º `png`ã€`jpeg`ã€`webp`ï¼Œé»˜è®¤ä¸º `png` ğŸ–¼ï¸ã€‚
- `width`: å›¾ç‰‡å®½åº¦ï¼Œé»˜è®¤ä¸º `600` ğŸ“ã€‚
- `isFirstProgressFullyVisible`: æ¨ªå‘æŸ±çŠ¶å›¾ç¬¬ä¸€åçš„è¿›åº¦æ¡æ˜¯å¦å æ»¡ï¼ˆå¯¹æ ·å¼ 3 æ— æ•ˆï¼‰ï¼Œé»˜è®¤ä¸º `false` ğŸ“Šã€‚
- `maxHorizontalBarLabelLengthBeforeTruncation`: æ¨ªå‘æŸ±çŠ¶å›¾æ ‡ç­¾æœ€å¤§é•¿åº¦ï¼Œè¶…è¿‡åˆ™æˆªæ–­ï¼Œé»˜è®¤ä¸º `10` ğŸ·ï¸ã€‚
- `waitUntil`: ï¼ˆä»…æ ·å¼ 3ï¼‰ç­‰å¾…é¡µé¢åŠ è½½çš„äº‹ä»¶ â³ã€‚
- `shouldMoveIconToBarEndLeft`: ï¼ˆä»…æ ·å¼ 3ï¼‰æ˜¯å¦å°†è‡ªå®šä¹‰å›¾æ ‡ç§»åŠ¨åˆ°æ°´å¹³æŸ±çŠ¶æ¡æœ«ç«¯çš„å·¦ä¾§ï¼ˆé»˜è®¤æ”¾åœ¨ç”¨æˆ·åçš„å³ä¾§ï¼‰ï¼Œé»˜è®¤ä¸º
  `false` ğŸ“ã€‚
- `horizontalBarBackgroundOpacity`: ï¼ˆä»…æ ·å¼ 3ï¼‰æ°´å¹³æŸ±çŠ¶å›¾èƒŒæ™¯å›¾ç‰‡ä¸é€æ˜åº¦ï¼Œé»˜è®¤ä¸º `0.6` ğŸŒ«ï¸ã€‚
- `horizontalBarBackgroundFullOpacity`: ï¼ˆä»…æ ·å¼ 3ï¼‰æ°´å¹³æŸ±çŠ¶å›¾èƒŒæ™¯å›¾ç‰‡æ•´æ¡çš„ä¸é€æ˜åº¦ï¼Œé»˜è®¤ä¸º `0` ğŸŒ«ï¸ã€‚
- `horizontalBarChartStyle`: æ°´å¹³æŸ±çŠ¶å›¾æ ·å¼ï¼Œå¯é€‰å€¼ä¸º `1`ã€`2`ã€`3`ï¼Œé»˜è®¤ä¸º `3` ğŸ“Šã€‚

### è‡ªåŠ¨æ¨é€è®¾ç½®

- `autoPush`: æ˜¯å¦è‡ªåŠ¨æ¨é€æ’è¡Œæ¦œï¼Œé»˜è®¤ä¸º `false` ğŸ‘Œã€‚
  - `shouldSendDailyLeaderboardAtMidnight`: æ˜¯å¦åœ¨æ¯æ—¥ 0 ç‚¹è‡ªåŠ¨å‘é€æ’è¡Œæ¦œï¼Œé»˜è®¤ä¸º `true` ğŸ•›ã€‚
  - `dailyScheduledTimers`: æ¯æ—¥å®šæ—¶å‘é€ç”¨æˆ·ä»Šæ—¥å‘è¨€æ’è¡Œæ¦œçš„æ—¶é—´åˆ—è¡¨ï¼ˆä¸­å›½åŒ—äº¬æ—¶é—´ï¼‰ï¼Œä¾‹å¦‚ `08:00`ã€`18:45`ã€‚å¦‚æœå¼€å¯
    `shouldSendDailyLeaderboardAtMidnight` é€‰é¡¹ï¼Œåˆ™è‡ªåŠ¨åŒ…å« 0 ç‚¹ â°ã€‚
  - `isGeneratingRankingListPromptVisible`: æ˜¯å¦åœ¨ç”Ÿæˆæ’è¡Œæ¦œæ—¶æ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼Œé»˜è®¤ä¸º `true` ğŸ’¬ã€‚
  - `leaderboardGenerationWaitTime`: æç¤ºæ¶ˆæ¯å‘é€åï¼Œè‡ªåŠ¨ç”Ÿæˆæ’è¡Œæ¦œçš„ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œé»˜è®¤ä¸º `3` â³ã€‚
  - `pushChannelIds`: å¯ç”¨è‡ªåŠ¨æ¨é€æ’è¡Œæ¦œåŠŸèƒ½çš„é¢‘é“ ID åˆ—è¡¨ [] ğŸ“¢ã€‚
  - `shouldSendLeaderboardNotificationsToAllChannels`: æ˜¯å¦å‘æ‰€æœ‰é¢‘é“æ¨é€æ’è¡Œæ¦œï¼Œé»˜è®¤ä¸º `false` ğŸŒã€‚
  - `excludedLeaderboardChannels`:  ä¸æ¨é€æ’è¡Œæ¦œçš„é¢‘é“ ID åˆ—è¡¨ [] ğŸ”•ã€‚
  - `delayBetweenGroupPushesInSeconds`: ç¾¤ç»„æ¨é€ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œé»˜è®¤ä¸º `5` â±ï¸ã€‚
  - `groupPushDelayRandomizationSeconds`:  ç¾¤ç»„æ¨é€å»¶è¿Ÿæ—¶é—´çš„éšæœºåŒ–æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œé»˜è®¤ä¸º `10` ğŸ²ã€‚

### ç”¨æˆ·ç¦è¨€è®¾ç½®

- `enableMostActiveUserMuting`: æ˜¯å¦ç¦è¨€æ¯å¤©å‘è¨€æœ€å¤šçš„ç”¨æˆ·ï¼ˆé¾™ç‹ï¼‰ï¼Œé»˜è®¤ä¸º `false` ğŸ™Šã€‚
  - `dragonKingDetainmentTime`:  å…³æŠ¼é¾™ç‹çš„ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œé»˜è®¤ä¸º `5` â³ã€‚
  - `detentionDuration`:  å…³æŠ¼æ—¶é•¿ï¼Œå•ä½æ˜¯å¤©ï¼Œé»˜è®¤ä¸º `1` ğŸ“…ã€‚
  - `muteChannelIds`: å¯ç”¨å…³æŠ¼é¾™ç‹åŠŸèƒ½çš„é¢‘é“ ID åˆ—è¡¨ [] ğŸ™Šã€‚

## ğŸ“ å‘½ä»¤

### messageCounter

- `messageCounter`: æŸ¥çœ‹ messageCounter æ’ä»¶å¸®åŠ© â“ã€‚
- `messageCounter.åˆå§‹åŒ–`: åˆå§‹åŒ–æ’ä»¶ï¼Œæ¸…ç©ºæ•°æ®è¡¨ï¼Œå°†æ’ä»¶è¿˜åŸè‡³åˆå§‹çŠ¶æ€ï¼Œéœ€è¦æƒé™ç­‰çº§ 3 çº§åŠä»¥ä¸Š ğŸ™ã€‚
- `messageCounter.æŸ¥è¯¢ [targetUser]`: æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„å‘è¨€æ¬¡æ•°ä¿¡æ¯ï¼ˆæ¬¡æ•°[æ’å]ï¼‰ğŸ”ã€‚

  - `--yesterday`/`-d`/`-w`/`-m`/`-y`/`-t`: åˆ†åˆ«æŸ¥è¯¢æ˜¨æ—¥/ä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´/æ€»å‘è¨€æ¬¡æ•°[æ’å] ğŸ—“ï¸ã€‚
  - `--ydag`/`--dag`/`--wag`/`--mag`/`--yag`/`-a`: åˆ†åˆ«æŸ¥è¯¢è·¨ç¾¤æ˜¨æ—¥/ä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´/æ€»å‘è¨€æ¬¡æ•°[æ’å] ğŸŒã€‚


- `messageCounter.æ’è¡Œæ¦œ [number]`: å‘è¨€æ’è¡Œæ¦œï¼Œå¯ä»¥æŒ‡å®šæ˜¾ç¤ºçš„äººæ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹æ¥æŒ‡å®šæ’è¡Œæ¦œçš„ç±»å‹ ğŸ†ï¼š

  - `--whites`: ç™½åå•ï¼Œåªæ˜¾ç¤ºç™½åå•ç”¨æˆ·ï¼Œå¯ç”¨ç©ºæ ¼ã€ä¸­è‹±æ–‡é€—å·å’Œé¡¿å·ä½œä¸ºåˆ†éš”ç¬¦ ğŸ‘¼ã€‚
  - `--blacks`: é»‘åå•ï¼Œä¸æ˜¾ç¤ºé»‘åå•ç”¨æˆ·ï¼Œå¯ç”¨ç©ºæ ¼ã€ä¸­è‹±æ–‡é€—å·å’Œé¡¿å·ä½œä¸ºåˆ†éš”ç¬¦ ğŸ‘¿ã€‚
  - `--yesterday`/`-d`/`-w`/`-m`/`-y`/`-t`:  åˆ†åˆ«æŸ¥è¯¢æ˜¨æ—¥/ä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´/æ€»å‘è¨€æ’è¡Œæ¦œ ğŸ—“ï¸ã€‚
  - `--ydag`/`--dag`/`--wag`/`--mag`/`--yag`/`--dragon`: åˆ†åˆ«æŸ¥è¯¢è·¨ç¾¤æ˜¨æ—¥/ä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´/æ€»å‘è¨€æ’è¡Œæ¦œï¼ˆåœ£é¾™ç‹æ¦œï¼‰
    ğŸŒğŸ²ã€‚
  - è‹¥æœªæŒ‡å®šæ’è¡Œæ¦œç±»å‹ï¼Œåˆ™é»˜è®¤ä¸ºä»Šæ—¥å‘è¨€æ¦œ ğŸ’¬ã€‚

- `messageCounter.ç¾¤æ’è¡Œæ¦œ [number:number]`:  å„ä¸ªç¾¤èŠçš„å‘è¨€æ’è¡Œæ¦œï¼Œå¯ä»¥æŒ‡å®šæ˜¾ç¤ºçš„æ•°é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹æ¥æŒ‡å®šæ’è¡Œæ¦œçš„ç±»å‹
  ğŸ†ï¼š

  - `-s`: æŒ‡å®šç”¨æˆ·çš„ç¾¤å‘è¨€æ’è¡Œæ¦œï¼Œå¯ç”¨ at æˆ– ç”¨æˆ· ID æŒ‡å®š ğŸ‘¤ã€‚
  - `--whites`: ç™½åå•ï¼Œåªæ˜¾ç¤ºç™½åå•ç¾¤ï¼Œå¯ç”¨ç©ºæ ¼ã€ä¸­è‹±æ–‡é€—å·å’Œé¡¿å·ä½œä¸ºåˆ†éš”ç¬¦ ğŸ‘¼ã€‚
  - `--blacks`: é»‘åå•ï¼Œä¸æ˜¾ç¤ºé»‘åå•ç¾¤ï¼Œå¯ç”¨ç©ºæ ¼ã€ä¸­è‹±æ–‡é€—å·å’Œé¡¿å·ä½œä¸ºåˆ†éš”ç¬¦ ğŸ‘¿ã€‚
  - `-d`/`-w`/`-m`/`-y`/`-t`/`--yesterday`: åˆ†åˆ«æŸ¥è¯¢æ˜¨æ—¥/ä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆ/ä»Šå¹´/æ€»å‘è¨€æ’è¡Œæ¦œ ğŸ—“ï¸ã€‚
  - è‹¥æœªæŒ‡å®šæ’è¡Œæ¦œç±»å‹ï¼Œåˆ™é»˜è®¤ä¸ºä»Šæ—¥å‘è¨€æ¦œ ğŸ’¬ã€‚

## ğŸŒ¸ ç¤ºä¾‹æˆªå›¾

> ç‰¹æ­¤æ„Ÿè°¢ [nullbczd](https://forum.koishi.xyz/u/nullbczd/summary) å¤§äººï¼å–µ ~ï¼ï¼ï¼ ğŸ˜½
![2ca8001d759e64dcecb8a952e3f23a4f](https://github.com/araea/koishi-plugin-message-counter/assets/120614554/3eb50393-00a2-4400-b4fd-d54d3acee390)

## ğŸ™ è‡´è°¢

* [Koishi](https://koishi.chat/) - æœºå™¨äººæ¡†æ¶ ğŸ¤–
* [Akisa](https://forum.koishi.xyz/u/akisa/summary) - Akisa å¤§äººæˆ‘çˆ±ä½ ï¼ğŸ’–
* [node-schedule](https://www.npmjs.com/package/node-schedule) - å®šæ—¶ä»»åŠ¡åº“ ğŸ•’
* [shangxue](https://forum.koishi.xyz/u/shangxue/summary) - æ„Ÿè°¢ä¸Šå­¦å¤§äººå¯¹æ¨é€æ‰€æœ‰é¢‘é“é…ç½®é¡¹çš„å»ºè®®ï¼ğŸ‘
* [nullbczd](https://forum.koishi.xyz/u/nullbczd/summary) - æ„Ÿè°¢ nullbczd å¤§äººå¯¹æ°´å¹³æŸ±çŠ¶å›¾æ ·å¼ç­‰åŠŸèƒ½çš„è´¡çŒ®ï¼ğŸ‘

## ğŸ± QQ ç¾¤

- 956758505

## âœ¨ License

MIT License Â© 2024

å¸Œæœ›æ‚¨å–œæ¬¢è¿™æ¬¾æ’ä»¶ï¼ ğŸ’«

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è”ç³»æˆ‘ï¼ ğŸˆ
